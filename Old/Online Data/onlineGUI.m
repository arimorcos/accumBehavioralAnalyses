%onlineGUI.m

%function to create the GUI for online data processing

function [guiObjects] = onlineGUI()
    
    screens = get(0,'MonitorPositions');
    if size(screens,1) > 1
        scrn = screens(2,:);
    else
        scrn = screens(1,:);
    end
    
    guiObjects.figHandle = figure('Name','Live ViRMEn Data','NumberTitle','Off','MenuBar','none');
    set(guiObjects.figHandle,'OuterPosition',[scrn(1) scrn(2) 0.5*(scrn(3)-scrn(1)) scrn(4)]);
    
    guiObjects.table = uitable('FontName','Arial','FontSize',14,'RowStriping','on','BackgroundColor',...
            [1 1 1; 0.8 0.8 0.8],'Units','normalized','Position',[0 .2 1 .4]);
    
    %start stop pause buttons
    guiObjects.stop = uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
            'Position',[.025 .05 .2 .04],'String','Stop','Style','pushbutton','BackgroundColor',[0.7969 0.7969 0.7969]);
    guiObjects.start = uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
            'Position',[.025 .14 .2 .04],'String','Start','Style','pushbutton','BackgroundColor',[0.7969 0.7969 0.7969]);
    guiObjects.pause = uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
            'Position',[.025 .095 .2 .04],'String','Pause','Style','togglebutton','BackgroundColor',[0.7969 0.7969 0.7969]);
    
    %create listbox for modules
    guiObjects.moduleList = uicontrol('FontName','Arial','FontSize',12,'FontWeight','bold','ForegroundColor',[0 0 0],...
        'Units','Normalized','Position',[.25 .1 .2 .08],'Style','listbox','BackgroundColor',[1 1 1],...
        'String',{'Significance','Run Speed','Previous Trial Effect'},'HorizontalAlignment','Center');    
    
    %create button for running
    guiObjects.runModule = uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
            'Position',[.25 .05 .2 .04],'String','Run Module','Style','pushbutton','BackgroundColor',[0.7969 0.7969 0.7969]);        
        
    %set text entry for lastX, winSize and total sessionTime
    uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.49 0.055 0.125 0.02],'String','LastX: ','Style','text','BackgroundColor',[0.7969 0.7969 0.7969]);
    guiObjects.lastX = uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.64 0.05 0.13 0.03],'String','40','Style','edit'); 
    
    guiObjects.sessionText = uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.46 0.095 0.18 0.02],'String','Session Time: ','Style','text','BackgroundColor',[0.7969 0.7969 0.7969]);
    guiObjects.sessionTime = uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.64 0.09 0.13 0.03],'String','00:45:00','Style','edit');
    
    uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.46 0.135 0.18 0.02],'String','Window Size: ','Style','text','BackgroundColor',[0.7969 0.7969 0.7969]);
    guiObjects.winSize = uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.64 0.13 0.13 0.03],'String','5','Style','edit'); 
    
    guiObjects.winText = uicontrol('FontName','Arial','FontSize',20,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.1 0.775 0.8 0.05],'String','Window Has Not Yet Elapsed','Style','text','BackgroundColor',[0.7969 0.7969 0.7969]);
    guiObjects.calcText = uicontrol('FontName','Arial','FontSize',20,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.1 0.775 0.8 0.05],'String','Calculating...','Style','text','BackgroundColor',[0.7969 0.7969 0.7969],...
        'visible','off');
    
    
    %Create checkboxes
    uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.805 0.18 0.2 0.02],'String','Show?','Style','text','BackgroundColor',[0.7969 0.7969 0.7969]);
    uicontrol('FontName','Arial','FontSize',13,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.79 0.15 0.2 0.02],'String','Percent Correct:','Style','text','BackgroundColor',[0.7969 0.7969 0.7969],'HorizontalAlignment','Left');
    uicontrol('FontName','Arial','FontSize',13,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.79 0.12 0.2 0.02],'String','Trials:','Style','text','BackgroundColor',[0.7969 0.7969 0.7969],'HorizontalAlignment','Left');
    uicontrol('FontName','Arial','FontSize',13,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.79 0.09 0.2 0.02],'String','Left:','Style','text','BackgroundColor',[0.7969 0.7969 0.7969],'HorizontalAlignment','Left');
    uicontrol('FontName','Arial','FontSize',13,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.79 0.06 0.2 0.02],'String','White:','Style','text','BackgroundColor',[0.7969 0.7969 0.7969],'HorizontalAlignment','Left');
    uicontrol('FontName','Arial','FontSize',13,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.79 0.03 0.2 0.02],'String','Legend:','Style','text','BackgroundColor',[0.7969 0.7969 0.7969],'HorizontalAlignment','Left');
    
    guiObjects.percCorrCheck = uicontrol('Units','Normalized','Position',[0.97 0.1575 0.04 0.01],'style','checkbox',...
        'BackgroundColor',[0.7969 0.7969 0.7969],'Value',1);
    guiObjects.trialCheck = uicontrol('Units','Normalized','Position',[0.97 0.1275 0.04 0.01],'style','checkbox',...
        'BackgroundColor',[0.7969 0.7969 0.7969],'Value',1);
    guiObjects.leftCheck = uicontrol('Units','Normalized','Position',[0.97 0.0975 0.04 0.01],'style','checkbox',...
        'BackgroundColor',[0.7969 0.7969 0.7969],'Value',0);
    guiObjects.whiteCheck = uicontrol('Units','Normalized','Position',[0.97 0.0675 0.04 0.01],'style','checkbox',...
        'BackgroundColor',[0.7969 0.7969 0.7969],'Value',0);
    guiObjects.legendCheck = uicontrol('Units','Normalized','Position',[0.97 0.0375 0.04 0.01],'style','checkbox',...
        'BackgroundColor',[0.7969 0.7969 0.7969],'Value',0);
    
    guiObjects.nothingChecked = uicontrol('FontName','Arial','FontSize',20,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.1 0.775 0.8 0.05],'String','Nothing Checked','Style','text','BackgroundColor',[1 1 1],...
        'visible','off');
    
    %Create condition display 
    uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],'Units','Normalized',...
        'Position',[0.65 0.605 0.2 0.02],'String','Condition: ','Style','text','BackgroundColor',[0.7969 0.7969 0.7969],...
        'HorizontalAlignment','Left');
    guiObjects.condText = uicontrol('FontName','Arial','FontSize',15,'FontWeight','bold','ForegroundColor',[0 0 0],...
        'Units','Normalized','Position',[0.77 0.605 0.3 0.02],'String','','Style','text',...
        'BackgroundColor',[0.7969 0.7969 0.7969],'HorizontalAlignment','Left');
    
    %set callback for start button
    set(guiObjects.start,'Callback',{@startOnlineAq,guiObjects});
    set(guiObjects.stop,'Callback',{@stopOnlineAq,guiObjects});
end